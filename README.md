# Шаблон универсального сервиса

В шаблоне универсального сервиса содержатся инструменты для взаимодействия 
с другими сервисами и реестрами, а так же задана структура организации файлов и методов.

В файле .env должны содержаться переменные:
* адрес реестра, к которому обращается сервис, например, SERVICE_REGISTRY_URL=https://reg.service.skroy.ru/api
* адреса других сервисов, к которым обращается сервис, например, USER_PROFILES_API_URL=https://api.users.skroy.ru/
* для подключения авторизации должны быть указаны
  * AUTH_PATH=/config/.auth
  * JWT_ALGORITHM=RS256
  * ACCESS_TOKEN_PUBLIC_KEY=-----BEGIN PUBLIC KEY-----\n{public_key}\n-----END PUBLIC KEY-----

[Назначение и проверка прав](https://git.infra.cloveri.com/eitica/knowhow/wiki/-/wikis/API/Auth#%D0%BD%D0%B0%D0%B7%D0%BD%D0%B0%D1%87%D0%B5%D0%BD%D0%B8%D0%B5-%D0%B8-%D0%BF%D1%80%D0%BE%D0%B2%D0%B5%D1%80%D0%BA%D0%B0-%D0%BF%D1%80%D0%B0%D0%B2)

Адрес реестра должен быть дополнен именем реестра при обращении. 
Имена реестров прописываются в app.services.utils в классе RegistryName. 

Методы сервисов прописываются в app.services.utils в классе Handle. 
Переменные в метод сервиса можно передавать через resolve(). 
Например, Handle.REPORTS_REPORT_ID.resolve(report_id="3fa85f64-5717-4562-b3fc-2c963f66afa6")

Основная бизнес-логика помещается в функцию вызываемого метода.
Если бизнес-логика сложно-составная, то необходимо разбить ее на отдельные функции,
поместить их либо в модуль app.services.utils (для типовых функций, которые могут вызываться и другими методами), 
либо в модуль utils посвященный роутеру, например, app.services.service_utils, а затем вызывать эти функции из 
главной функции метода.
